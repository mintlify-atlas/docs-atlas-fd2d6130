---
title: 'Quickstart'
description: 'Create your first embedded file system with Broccoli in under 5 minutes'
---

This guide walks you through creating a simple HTTP server that serves static files embedded in your Go binary using Broccoli.

## Project Setup

<Steps>
  <Step title="Create a new Go module">
    ```bash
    mkdir broccoli-demo
    cd broccoli-demo
    go mod init example.com/broccoli-demo
    ```
  </Step>
  
  <Step title="Create your static files">
    Create a `public` directory with some static content:
    
    ```bash
    mkdir public
    ```
    
    Create `public/index.html`:
    
    ```html
    <!DOCTYPE html>
    <html>
    <head>
        <title>Broccoli Demo</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <h1>Hello from Broccoli!</h1>
        <p>These files are embedded in the binary.</p>
    </body>
    </html>
    ```
    
    Create `public/style.css`:
    
    ```css
    body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
        background: #f5f5f5;
    }
    
    h1 {
        color: #2c5f2d;
    }
    ```
  </Step>
  
  <Step title="Create your Go application">
    Create `main.go` with the following content:
    
    ```go
    package main

    import (
        "log"
        "net/http"
    )

    //go:generate broccoli -src=public -o assets

    func main() {
        log.Println("Server starting on http://localhost:8080")
        http.ListenAndServe(":8080", assets.Serve("public"))
    }
    ```
    
    <Tip>
    The `//go:generate` directive tells Go to run the `broccoli` command during `go generate`. The `-src` flag specifies the source directory, and `-o` sets the output filename.
    </Tip>
  </Step>
  
  <Step title="Generate the embedded file system">
    ```bash
    go generate
    ```
    
    This creates `assets.gen.go` containing your compressed files. The file will look something like:
    
    ```go
    // Code generated by broccoli at 2026-02-20T10:30:00Z.
    package main

    import "aletheia.icu/broccoli/fs"

    var assets = fs.New(false, []byte("...compressed data..."))
    ```
  </Step>
  
  <Step title="Build and run">
    ```bash
    go build
    ./broccoli-demo
    ```
    
    Open http://localhost:8080 in your browser to see your embedded files served!
  </Step>
</Steps>

## Understanding the Code

Let's break down what's happening:

### The go:generate Directive

```go
//go:generate broccoli -src=public -o assets
```

- `broccoli` - Runs the broccoli CLI tool
- `-src=public` - Embeds files from the `public` directory
- `-o assets` - Creates `assets.gen.go` with a variable named `assets`

### Serving Files

```go
http.ListenAndServe(":8080", assets.Serve("public"))
```

The `Serve` method returns an `http.Handler` that serves files from the embedded file system. It strips the specified prefix (`"public"`) when matching routes.

## Working with Multiple Directories

You can bundle files from multiple source directories:

```go
//go:generate broccoli -src=public,static,assets -o bundle
```

Access them by their original paths:

```go
file, err := bundle.Open("static/logo.png")
```

## Walking the File System

Use the `Walk` method to iterate over embedded files:

```go
package main

import (
    "fmt"
    "os"
)

//go:generate broccoli -src=public -o assets

func init() {
    assets.Walk("public", func(path string, info os.FileInfo, err error) error {
        if err != nil {
            return err
        }
        fmt.Printf("File: %s, Size: %d bytes\n", path, info.Size())
        return nil
    })
}
```

## Advanced Options

<CodeGroup>
```go Optional Decompression
//go:generate broccoli -src=public -o assets -opt

// Files are only decompressed when first accessed
// Reduces memory usage for large bundles
```

```go Custom Compression Level
//go:generate broccoli -src=public -o assets -quality=6

// Use compression level 6 (1-11)
// Lower = faster but larger, higher = slower but smaller
```

```go Include Specific Files
//go:generate broccoli -src=public -o assets -include="*.html,*.css"

// Only embed HTML and CSS files
```

```go Exclude Files
//go:generate broccoli -src=public -o assets -exclude="*.tmp,*.log"

// Exclude temporary and log files
```

```go Respect .gitignore
//go:generate broccoli -src=public -o assets -gitignore

// Automatically skip files ignored by .gitignore
```

```go Custom Variable Name
//go:generate broccoli -src=templates -o views -var=tmpl

// Creates a variable named 'tmpl' instead of 'views'
func main() {
    http.ListenAndServe(":8080", tmpl.Serve("templates"))
}
```
</CodeGroup>

## Development Mode

For faster development, you can use the file system directly instead of the embedded bundle:

```go
package main

import (
    "net/http"
    "os"
)

//go:generate broccoli -src=public -o assets

func main() {
    // Use local files in development
    if os.Getenv("PRODUCTION") == "" {
        assets.Development(true)
    }
    
    http.ListenAndServe(":8080", assets.Serve("public"))
}
```

<Note>
When development mode is enabled, Broccoli reads from the local file system instead of the embedded bundle. This allows you to see changes without regenerating.
</Note>

## Opening Individual Files

You can also open and read individual files:

```go
package main

import (
    "fmt"
    "io"
)

//go:generate broccoli -src=public -o assets

func main() {
    file, err := assets.Open("public/index.html")
    if err != nil {
        panic(err)
    }
    defer file.Close()
    
    content, err := io.ReadAll(file)
    if err != nil {
        panic(err)
    }
    
    fmt.Println(string(content))
}
```

## Next Steps

Now that you've created your first embedded file system, explore more advanced features:

<CardGroup cols={2}>
  <Card
    title="API Reference"
    icon="code"
    href="/api-reference"
  >
    Detailed documentation of all Broccoli methods and options
  </Card>
  <Card
    title="Best Practices"
    icon="star"
    href="/best-practices"
  >
    Learn optimization techniques and common patterns
  </Card>
</CardGroup>
